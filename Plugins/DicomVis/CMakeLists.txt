cmake_minimum_required (VERSION 2.8)

add_library(DicomVis MODULE "DicomVis.cpp" "ImageLoader.cpp")
link_plugin(DicomVis)

if(WIN32)
	if(DEFINED ENV{DCMTK_HOME})
		message(STATUS "Found DCMTK_HOME: $ENV{DCMTK_HOME}")
	else()
		message(FATAL_ERROR "Error: DCMTK_HOME not set!")
	endif()
	target_include_directories(DicomVis PUBLIC "$ENV{DCMTK_HOME}/include")
	
	if (CMAKE_BUILD_TYPE STREQUAL "Debug")
		target_link_directories(DicomVis PUBLIC "$ENV{DCMTK_HOME}/lib/Debug")
	else()
		target_link_directories(DicomVis PUBLIC "$ENV{DCMTK_HOME}/lib/Release")
	endif()
	target_link_libraries(DicomVis "Ws2_32.lib" "Netapi32.lib" "Iphlpapi.lib" "ofstd.lib" "oflog.lib" "dcmdata.lib" "dcmimgle.lib")
else()
	target_link_libraries(DicomVis "libz.so" "libofstd.so" "liboflog.so" "libdcmdata.so" "libdcmimgle.so")
endif()

add_shader_target(DicomShaders "Shaders/")
add_dependencies(DicomVis DicomShaders)