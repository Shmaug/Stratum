cmake_minimum_required(VERSION 3.7)

project(Stratum)
set(CMAKE_CXX_STANDARD 20)

set(STRATUM_DIR ${CMAKE_CURRENT_LIST_DIR})
set(EXTERN_DIR ${CMAKE_CURRENT_LIST_DIR}/extern)

list(APPEND CMAKE_MODULE_PATH ${EXTERN_DIR})
list(APPEND CMAKE_PREFIX_PATH ${EXTERN_DIR})

find_package(Vulkan REQUIRED)
find_package(Eigen3 REQUIRED)
find_package(OpenXR CONFIG REQUIRED)
find_package(assimp CONFIG REQUIRED)

set(STRATUM_VERSION_MAJOR 1)
set(STRATUM_VERSION_MINOR 2)

option(ENABLE_DEBUG_LAYERS "Enable debug layers" TRUE)

list(APPEND STM_COMPILE_DEFINITIONS STRATUM_VERSION_MAJOR=${STRATUM_VERSION_MAJOR} STRATUM_VERSION_MINOR=${STRATUM_VERSION_MINOR} XR_USE_GRAPHICS_API_VULKAN _USE_MATH_DEFINES)
if (${ENABLE_DEBUG_LAYERS})
	list(APPEND STM_COMPILE_DEFINITIONS ENABLE_DEBUG_LAYERS)
endif()
if (WIN32)
	add_compile_options(/bigobj)
	list(APPEND STM_COMPILE_DEFINITIONS WINDOWS WIN32_LEAN_AND_MEAN NOMINMAX _CRT_SECURE_NO_WARNINGS VK_USE_PLATFORM_WIN32_KHR)
endif(WIN32)

include_directories(${EXTERN_DIR}/include)
link_directories(${EXTERN_DIR}/lib)

add_subdirectory(src)
add_subdirectory(Plugins/DicomVis)